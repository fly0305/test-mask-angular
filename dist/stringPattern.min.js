!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.stringPattern=n():e.stringPattern=n()}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var o=t(5);Object.defineProperty(n,"conformToPattern",{enumerable:!0,get:function(){return r(o)["default"]}});var u=t(3);Object.defineProperty(n,"adjustCursorPosition",{enumerable:!0,get:function(){return r(u)["default"]}})},function(e,n,t){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return e.replace(/1/g,l.placeholderCharacter)}function o(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],t=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return e.substring(0,n)+e.substring(n+t)}function u(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return e.length===n.length?l.operationTypes.replacement:e.length>n.length?l.operationTypes.addition:e.length<n.length?l.operationTypes.deletion:null}function a(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return e.split("").reduce(function(e,n){return-1===l.maskingCharacters.indexOf(n)&&-1===e.indexOf(n)&&e.push(n),e},[])}function i(e,n){return Array.from({length:n},function(){return e}).join("")}function s(e){return e.reduce(function(e,n){var t=n.content,r=void 0===t?"":t,o=n.length,u=n.delimiter,a=o-r.length,s=i(l.placeholderCharacter,a);return e+=r+s+(u||"")},"")}Object.defineProperty(n,"__esModule",{value:!0}),n.convertPatternToPlaceholder=r,n.removeCharactersStartingAtIndex=o,n.getOperationType=u,n.getDelimiters=a,n.printPadding=i,n.constructConformedString=s;var l=t(2)},function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.operationTypes={replacement:"replacement",addition:"addition",deletion:"deletion"},n.maskingCharacters=["1","A","#"],n.placeholderCharacter="_"},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=arguments.length<=1||void 0===arguments[1]?"":arguments[1],t=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?"":arguments[3];if(e===n)return t;var o=a["default"].diffChars(e,n),u=0,l=0,f="",d=-1,c=null;if(o.forEach(function(e){f+=e.value,e.added===!0&&(u+=e.count,c=e.value===s.placeholderCharacter,d=-1===d?f.length-1:d),e.removed===!0&&(l+=e.count,d=-1===d?f.length-1:d)}),d-t>1)return t;if(u>1||l>1)return t;var h=(0,i.convertPatternToPlaceholder)(r);if(c!==!0&&void 0!==h[d+1]&&h[d+1]!==s.placeholderCharacter){for(var g=d+2;g<h.length;g++)if(h[g]===s.placeholderCharacter)return g;return t}if(c===!0&&void 0!==h[d-1]&&h[d-1]!==s.placeholderCharacter){for(var g=d-2;g>0;g--)if(h[g]===s.placeholderCharacter)return g+1;return t}return c?d:d+1}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=o;var u=t(9),a=r(u),i=t(1),s=t(2)},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],t=0,r="";return e.map(function(e){if(0===e.length)return e;var o=n&&n[t]?r+n[t]:r,u=(0,a["default"])(o,length),i=u.remainder,s=u.results;return r=i,t++,e.content=s,e})}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=o;var u=(t(1),t(8)),a=r(u)},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,n){var t=(0,i["default"])(n),r=(0,l["default"])(e,n),o=(0,d["default"])(t,r);return(0,u.constructConformedString)(o)}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=o;var u=t(1),a=t(6),i=r(a),s=t(7),l=r(s),f=t(4),d=r(f)},function(e,n,t){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=(0,u.convertPatternToPlaceholder)(e),t=[],r=0;return n.split("").forEach(function(e){e===o.placeholderCharacter?r++:(t.push({length:r,delimiter:e,content:""}),r=0)}),r>0&&t.push({length:r,delimiter:"",content:""}),t}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r;var o=t(2),u=t(1)},function(e,n,t){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=arguments.length<=1||void 0===arguments[1]?"":arguments[1],t=[],r=(0,o.getDelimiters)(n),u="";return e.split("").forEach(function(e){-1===r.indexOf(e)?u+=e:u.length>0&&(t.push(u),u="")}),u.length>0&&t.push(u),t}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r;var o=t(1)},function(e,n,t){"use strict";function r(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],t=e.substr(0,n),r=e.substr(n,e.length),a=n-t.length;return{results:t+(0,o.printPadding)(u.placeholderCharacter,a),remainder:r}}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r;var o=t(1),u=t(2)},function(e,n,t){var r,o;!function(t,u){function a(e,n,t){if(Array.prototype.map)return Array.prototype.map.call(e,n,t);for(var r=new Array(e.length),o=0,u=e.length;u>o;o++)r[o]=n.call(t,e[o],o,e);return r}function i(e){return{newPos:e.newPos,components:e.components.slice(0)}}function s(e){for(var n=[],t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n}function l(e){var n=e;return n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/"/g,"&quot;")}function f(e,n,t){n=n||[],t=t||[];var r;for(r=0;r<n.length;r+=1)if(n[r]===e)return t[r];var o;if("[object Array]"===h.call(e)){for(n.push(e),o=new Array(e.length),t.push(o),r=0;r<e.length;r+=1)o[r]=f(e[r],n,t);n.pop(),t.pop()}else if("object"==typeof e&&null!==e){n.push(e),o={},t.push(o);var u,a=[];for(u in e)a.push(u);for(a.sort(),r=0;r<a.length;r+=1)u=a[r],o[u]=f(e[u],n,t);n.pop(),t.pop()}else o=e;return o}function d(e,n,t,r){for(var o=0,u=e.length,i=0,s=0;u>o;o++){var l=e[o];if(l.removed){if(l.value=t.slice(s,s+l.count).join(""),s+=l.count,o&&e[o-1].added){var f=e[o-1];e[o-1]=e[o],e[o]=f}}else{if(!l.added&&r){var d=n.slice(i,i+l.count);d=a(d,function(e,n){var r=t[s+n];return r.length>e.length?r:e}),l.value=d.join("")}else l.value=n.slice(i,i+l.count).join("");i+=l.count,l.added||(s+=l.count)}}return e}function c(e){this.ignoreWhitespace=e}var h=Object.prototype.toString;c.prototype={diff:function(e,n,t){function r(e){return t?(setTimeout(function(){t(u,e)},0),!0):e}function o(){for(var t=-1*f;f>=t;t+=2){var o,c=h[t-1],g=h[t+1],p=(g?g.newPos:0)-t;c&&(h[t-1]=u);var v=c&&c.newPos+1<s,m=g&&p>=0&&l>p;if(v||m){if(!v||m&&c.newPos<g.newPos?(o=i(g),a.pushComponent(o.components,u,!0)):(o=c,o.newPos++,a.pushComponent(o.components,!0,u)),p=a.extractCommon(o,n,e,t),o.newPos+1>=s&&p+1>=l)return r(d(o.components,n,e,a.useLongestToken));h[t]=o}else h[t]=u}f++}var a=this;if(n===e)return r([{value:n}]);if(!n)return r([{value:e,removed:!0}]);if(!e)return r([{value:n,added:!0}]);n=this.tokenize(n),e=this.tokenize(e);var s=n.length,l=e.length,f=1,c=s+l,h=[{newPos:-1,components:[]}],g=this.extractCommon(h[0],n,e,0);if(h[0].newPos+1>=s&&g+1>=l)return r([{value:n.join("")}]);if(t)!function v(){setTimeout(function(){return f>c?t():void(o()||v())},0)}();else for(;c>=f;){var p=o();if(p)return p}},pushComponent:function(e,n,t){var r=e[e.length-1];r&&r.added===n&&r.removed===t?e[e.length-1]={count:r.count+1,added:n,removed:t}:e.push({count:1,added:n,removed:t})},extractCommon:function(e,n,t,r){for(var o=n.length,u=t.length,a=e.newPos,i=a-r,s=0;o>a+1&&u>i+1&&this.equals(n[a+1],t[i+1]);)a++,i++,s++;return s&&e.components.push({count:s}),e.newPos=a,i},equals:function(e,n){var t=/\S/;return e===n||this.ignoreWhitespace&&!t.test(e)&&!t.test(n)},tokenize:function(e){return e.split("")}};var g=new c,p=new c(!0),v=new c;p.tokenize=v.tokenize=function(e){return s(e.split(/(\s+|\b)/))};var m=new c(!0);m.tokenize=function(e){return s(e.split(/([{}:;,]|\s+)/))};var y=new c,P=new c;P.ignoreTrim=!0,y.tokenize=P.tokenize=function(e){for(var n=[],t=e.split(/^/m),r=0;r<t.length;r++){var o=t[r],u=t[r-1],a=u&&u[u.length-1];"\n"===o&&"\r"===a?n[n.length-1]=n[n.length-1].slice(0,-1)+"\r\n":(this.ignoreTrim&&(o=o.trim(),r<t.length-1&&(o+="\n")),n.push(o))}return n};var b=new c;b.tokenize=function(e){var n=[],t=e.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var r=0;r<t.length;r++){var o=t[r];r%2?n[n.length-1]+=o:n.push(o)}return n};var w=new c;w.tokenize=function(e){return s(e.split(/(\S.+?[.!?])(?=\s+|$)/))};var C=new c;C.useLongestToken=!0,C.tokenize=y.tokenize,C.equals=function(e,n){return y.equals(e.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};var _={Diff:c,diffChars:function(e,n,t){return g.diff(e,n,t)},diffWords:function(e,n,t){return p.diff(e,n,t)},diffWordsWithSpace:function(e,n,t){return v.diff(e,n,t)},diffLines:function(e,n,t){return y.diff(e,n,t)},diffTrimmedLines:function(e,n,t){return P.diff(e,n,t)},diffSentences:function(e,n,t){return w.diff(e,n,t)},diffCss:function(e,n,t){return m.diff(e,n,t)},diffJson:function(e,n,t){return C.diff("string"==typeof e?e:JSON.stringify(f(e),u,"  "),"string"==typeof n?n:JSON.stringify(f(n),u,"  "),t)},createTwoFilesPatch:function(e,n,t,r,o,u){function i(e){return a(e,function(e){return" "+e})}function s(e,n,t){var r=f[f.length-2],o=n===f.length-2,u=n===f.length-3&&t.added!==r.added;/\n$/.test(t.value)||!o&&!u||e.push("\\ No newline at end of file")}var l=[];e==n&&l.push("Index: "+e),l.push("==================================================================="),l.push("--- "+e+("undefined"==typeof o?"":"	"+o)),l.push("+++ "+n+("undefined"==typeof u?"":"	"+u));var f=b.diff(t,r);f.push({value:"",lines:[]});for(var d=0,c=0,h=[],g=1,p=1,v=0;v<f.length;v++){var m=f[v],y=m.lines||m.value.replace(/\n$/,"").split("\n");if(m.lines=y,m.added||m.removed){if(!d){var P=f[v-1];d=g,c=p,P&&(h=i(P.lines.slice(-4)),d-=h.length,c-=h.length)}h.push.apply(h,a(y,function(e){return(m.added?"+":"-")+e})),s(h,v,m),m.added?p+=y.length:g+=y.length}else{if(d)if(y.length<=8&&v<f.length-2)h.push.apply(h,i(y));else{var w=Math.min(y.length,4);l.push("@@ -"+d+","+(g-d+w)+" +"+c+","+(p-c+w)+" @@"),l.push.apply(l,h),l.push.apply(l,i(y.slice(0,w))),y.length<=4&&s(l,v,m),d=0,c=0,h=[]}g+=y.length,p+=y.length}}return l.join("\n")+"\n"},createPatch:function(e,n,t,r,o){return _.createTwoFilesPatch(e,e,n,t,r,o)},applyPatch:function(e,n){for(var t=n.split("\n"),r=[],o=0,u=!1,a=!1;o<t.length&&!/^@@/.test(t[o]);)o++;for(;o<t.length;o++)if("@"===t[o][0]){var i=t[o].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);r.unshift({start:i[3],oldlength:+i[2],removed:[],newlength:i[4],added:[]})}else"+"===t[o][0]?r[0].added.push(t[o].substr(1)):"-"===t[o][0]?r[0].removed.push(t[o].substr(1)):" "===t[o][0]?(r[0].added.push(t[o].substr(1)),r[0].removed.push(t[o].substr(1))):"\\"===t[o][0]&&("+"===t[o-1][0]?u=!0:"-"===t[o-1][0]&&(a=!0));var s=e.split("\n");for(o=r.length-1;o>=0;o--){for(var l=r[o],f=0;f<l.oldlength;f++)if(s[l.start-1+f]!==l.removed[f])return!1;Array.prototype.splice.apply(s,[l.start-1,l.oldlength].concat(l.added))}if(u)for(;!s[s.length-1];)s.pop();else a&&s.push("");return s.join("\n")},convertChangesToXML:function(e){for(var n=[],t=0;t<e.length;t++){var r=e[t];r.added?n.push("<ins>"):r.removed&&n.push("<del>"),n.push(l(r.value)),r.added?n.push("</ins>"):r.removed&&n.push("</del>")}return n.join("")},convertChangesToDMP:function(e){for(var n,t,r=[],o=0;o<e.length;o++)n=e[o],t=n.added?1:n.removed?-1:0,r.push([t,n.value]);return r},canonicalize:f};"undefined"!=typeof e&&e.exports?e.exports=_:(r=[],o=function(){return _}.apply(n,r),!(o!==u&&(e.exports=o)))}(this)}])});